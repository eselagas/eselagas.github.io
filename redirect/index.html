<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Redirecting...</title>
</head>
<body>
    <h1 style="display: none; text-align: center;" id="errDisplay">You could not be redirected at this time.</h1>
    <p id="redirectNotice" style="text-align: center;"></p>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const params = new URLSearchParams(window.location.search);
            let redirectUrl;

            if (params.has('r_type')) {
                const redType = params.get('r_type');
                switch (redType) {
                    case 'git_file_disp':
                        const repo = params.get('repo');
                        const path = params.get('pth');
                        if (repo && path) {
                            redirectUrl = `https://raw.githubusercontent.com/eselagas/${repo}/refs/heads/main/${path}`;
                        }
                        break;

                    case 'redirect':
                        redirectUrl = params.get('r');
                        break;

                    case 'download':
                        const redirect = params.get('r');
                        const dName = params.get('name');
                        if (redirect && dName) {
                            const link = document.createElement('a');
                            link.href = redirect;
                            link.download = dName;
                            link.rel = "noopener noreferrer";
                            document.body.appendChild(link);
                            link.click();
                            document.getElementById('redirectNotice').innerHTML = `If the download doesn't start automatically, <a href="${redirect}" id="redirectLink" download>click here</a>.`;
                            document.body.removeChild(link);
                            return;
                        }
                        break;
                }

                if (redirectUrl) {
                    document.getElementById('redirectNotice').innerHTML = `If you are not redirected automatically, <a href="${redirectUrl}">click here</a>.`;
                    window.location.href = redirectUrl;
                }
            } else {
                document.getElementById('errDisplay').style.display = 'block';
            }
        });
    </script>
</body>
</html>
